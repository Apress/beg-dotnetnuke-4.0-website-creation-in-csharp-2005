/************************************************************/
/*****              RegisterModule                      *****/
/*****                                                  *****/
/***** Use this script to register a module in the      *****/
/***** database using Query Analyzer                    *****/
/*****                                                  *****/
/*****                                                  *****/
/***** Note: To manually execute this script you must   *****/
/*****       perform a search and replace operation     *****/
/*****       for {databaseOwner} and {objectQualifier}  *****/
/*****                                                  *****/
/************************************************************/

exec {databaseOwner}[{objectQualifier}AddDesktopModule]
  @ModuleName = N'TimePunch', 
  @FolderName = N'TimePunch', 
  @FriendlyName = N'TimePunch', 
  @Description = N'A TimePunch module', 
  @Version = N'01.00.00', 
  @IsPremium = 0, 
  @IsAdmin = 0, 
  @BusinessController = N'YourCompany.Modules.TimePunch.TimePunchController', 
  @SupportedFeatures = 3

declare @DesktopModuleId int
select @DesktopModuleId = DesktopModuleId 
from {databaseOwner}[{objectQualifier}DesktopModules] 
where ModuleName = 'TimePunch'

exec {databaseOwner}[{objectQualifier}AddModuleDefinition] @DesktopModuleId, 
  @FriendlyName = N'TimePunch', 
  @DefaultCacheTime = 0

declare @ModuleDefID int
select @ModuleDefID = ModuleDefID 
from {databaseOwner}[{objectQualifier}ModuleDefinitions] 
where FriendlyName = 'TimePunch'

exec {databaseOwner}[{objectQualifier}AddModuleControl]
  @ModuleDefID, 
  @ControlKey = NULL, 
  @ControlTitle = NULL, 
  @ControlSrc = N'DesktopModules/TimePunch/ViewTimePunch.ascx', 
  @IconFile = NULL, 
  @ControlType = 0, 
  @ViewOrder = NULL, 
  @HelpUrl = NULL

exec {databaseOwner}[{objectQualifier}AddModuleControl]
  @ModuleDefID, 
  @ControlKey = 'Edit', 
  @ControlTitle = 'Edit Content', 
  @ControlSrc = N'DesktopModules/TimePunch/EditTimePunch.ascx', 
  @IconFile = NULL, 
  @ControlType = 1, 
  @ViewOrder = NULL, 
  @HelpUrl = NULL

exec {databaseOwner}[{objectQualifier}AddModuleControl]
  @ModuleDefID, 
  @ControlKey = 'Settings', 
  @ControlTitle = 'TimePunch Settings', 
  @ControlSrc = N'DesktopModules/TimePunch/Settings.ascx', 
  @IconFile = NULL, 
  @ControlType = 1, 
  @ViewOrder = NULL, 
  @HelpUrl = NULL
